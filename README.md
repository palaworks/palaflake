# palaflake

snowflake改进型分布式ID生成方案

## 概述

palaflake意在为低程度分布式场景提供ID生成方案，并通过时间回拨位与保留位为更多场景提供冗余可能。

## ID结构

palaflake同snowflake一样，采用64个二进制位来生成ID，但不同的是palaflake充分利用了第一位（符号位），即palaflake是一个u64值。

下面是一个标准的palaflake：

```text
11111111 11111111 11111111 11111111
11111111 22222222 00445555 55555555
```

前40位（被标识为1）用于表示精确到毫秒的时间戳，其最大使用年限为34年。

第41~48位（被标识为2）用作机器标识，最大可供256台设备同时生成ID。

第49~50位（被标识为0）用作保留，通常置0，但也可用于特别情况下提供冗余的ID空间。

第52~53位（被标识为4）用作时间回拨，每毫秒最多承受3次时间回拨。

最后12位（被标识为5）是序列号，支持每毫秒生成4096个ID。

## 最佳实践

为充分利用ID空间，请使用从项目启动时间开始的毫秒级时间戳。

palaflake默认支持高达每秒400万（4096000）的并发量，可通过降低前40位时间戳的精确程度来降低palaflake的并发程度以更加充分地利用ID空间（例如每10毫秒增加一次时间戳）。

保留位允许将palaflake的ID空间提升至原来的4倍，但建议的选择留作应急使用（例如标识因故障而生成了重复ID的机器）。

不建议将保留位用作校验。

## 实现

[C#](/impl/cs)  
[F#](/impl/fs)  
[Kotlin](/impl/kt)  
[Rust](/impl/rs)

均包含一份示例代码和一个可直接编译使用的Library。

## 许可证

The MIT License (MIT)
